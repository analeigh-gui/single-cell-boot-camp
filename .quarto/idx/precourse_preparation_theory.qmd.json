{"title":"Precourse Preparation - Theory","markdown":{"yaml":{"title":"Precourse Preparation - Theory","execute":{"warning":false,"message":false}},"headingText":"1. Introduction","containsRefs":false,"markdown":"\n\n\nOur body has many cell types with different functions and they interact with each other in a daily basis. We can imagine it like a bustling city with different workers specializing in different tasks.\n\nSingle-cell RNA sequencing (scRNAseq) can help to understand the cell types and their functionality. It's like taking a close-up picture of each cell and see which genes are active.\n\nThis technique can be applied to:\n\n-   Investigating different types of cells in a specific tissue. Example: Understanding the various cell types in the brain.\n\n-   Discovering noval cell types or states. Example: Identifying unique cell types in the immune system.\n\n-   Figuring out how genes change their activity as cells differentiate over time. Example: Tracking gene expression dynamics such as stem cells differentiation.\n\n-   Finding genes that are active in certain cell types under certain conditions. Example: Finding genes that switch on and off in lung cells in asthma.\n\n-   Examining how gene activity changes within a cell type under certain conditions. Example: Studying how nerve cells in the spinal cord change their gene activity in response to injury.\n\n# 2. BD Rhapsody^™^ Single Cell Workflow\n\nThe BD Rhapsody^™^ Single Cell System enables capturing and barcoding of hundreds to thousands of single cells for the analysis of genomic and proteomic information.\n\nBefore proceeding with Rhapsody workflow, samples of interest are processed to have **live** **single cells in cell suspension**. It is optional to sort cells to concentrate on cell type of interest.\n\nThe sample preparation and experimental setup are crucial and have big impacts on data quality and the following analysis. We expect live single cells in cell suspension (avoid clumps or dead cells).\n\n![](prerequisite_figures/BD_single_cell_workflow.png)\n\nOnce we obtain single cell suspension, the cells are captured and barcoded by the BD Rhapsody^™^ Single-Cell Analysis System. Each cell is assigned with a unique cell barcode and mRNA molecules of a cell are tagged with that barcode. This helps to associate the RNA molecules with the corresponding cell in downstream analysis.\n\nThe data analysis and interpretation come as the last piece of the workflow. The upstream steps, including experimental design and sample processing, will define the analysis process: how we approach quality control, data integration or cell annotation, etc.\n\nIn the next chapter, you will learn which modality can be measured on the single cell level with BD Rhapsody^™^ System.\n\n## 2.1 BD Rhapsody^™^ Single Cell System\n\n![](prerequisite_figures/BD_Rhapsody_assays_summary.png)\n\nThe BD Rhapsody™ Single Cell System enables simultaneous measurement of multiple parameters in thousands of individual cells. By combining available assays, researchers can generate robust and intricate datasets to unlock powerful insights.\n\n**Gene Expression (scRNAseq):** The primary purpose of scRNAseq is to measure the gene expression in individual cells. This allows to understand which genes are active or inactive and to identify different cell types based on their gene expression profiles.\n\n**Antibody-Based Protein Analysis (AbSeq):** You can use antibodies conjugated with unique barcodes to measure protein expression alongside with gene expression in individual cells.\n\n**Sample multiplexing with antibody-based techniques (SMK):** **S**ample **m**ultiplexing **k**it (SMK) uses generic antibody conjugated with unique barcodes to label cells from different samples. This enables pooling of multiple samples on one cartridge.\n\n**Immune Repertoire Profiling (Full length V(D)J TCR/BCR):** Full length V(D)J assay profiles the diversity of T cell and/or B cell receptor repertoires. This is valuable for studying the immune response and identifying antigen-specific cells.\n\n**Antigen-Specific T-cell Analysis (DCode):** Immudex's DCode technology enables the profiling of T cells that recognize specific antigens such as viral epitopes or tumor-related antigens. This expands the offering of immune profiling, aiding vaccine development and immunotherapy research.\n\nFrom gene expression profiling to antibody-based protein analysis, all assays can be combined or performed standalone to explore cellular functions and molecular dynamics in single cell resolution.\n\n## 2.2 Overview of Single Cell Data Analysis\n\nIn general, the analysis of single cell data can be split into two parts.\n\nThe **primary analysis** transforms raw data (usually in fastq.gz format) into an expression matrix, where each row represents a gene, each column represents a cell, and each entry in the matrix contains the molecule counts of a particular feature (gene or protein) in a cell. **Secondary analysis** focuses on extracting meaningful biological insights from the expression matrix.\n\n![](prerequisite_figures/primary_secondary_analyses.png)\n\n## 2.3 Primary analysis - From Sequencing Data to Expression Matrix\n\nAfter sequencing, one will receive raw sequecning data. The raw sequencing data is usually in fastq.gz format. You may also see fq.gz.\n\nThe raw sequencing data is usually handled by the software, BD Rhapsody^™^ Primary Analysis Pipeline, to enables fast and easy data processing. In this chapter, we will cover key features of the pipeline and explain key concepts necessary to understand prior working with single cell data.\n\n### 2.3.1 BD Rhapsody^™^ Sequencing Analysis Pipeline\n\nThe BD Rhapsody^™^ Sequencing Analysis Pipeline contains a series of computational steps to process and extract meaningful information from the raw sequencing data generated by the BD Rhapsody^™^ Sinlge Cell System.\n\nThe goal of the primary analysis is to transform text-based genomic data into numerical data, and we achieve this through a series of steps in the pipeline. The steps of the pipeline are listed in simplified graphics below.\n\n![](prerequisite_figures/sequencing_pipeline.png){width=\"1000\"}\n\nThe main steps include decoding the unique barcodes and feature molecules associated with individual cells. Oftentimes, scRNAseq relies on **u**nique **m**olecular **i**dentifiers (UMIs) to quantify feature expression.\n\n### 2.3.2 Quantify feature expression with UMIs\n\n**U**nique **m**olecular **i**dentifiers (UMIs) are used to quantify featuer molecules in a cell. Here's how it works:\n\n-   **Bead structure:** UMIs are small, unique sequences of nucleotides that are added to the capture sequence of beads. Each bead contains tens of thousands of unique UMIs followed by the polyA capture sequence. Each UMI is specific to the molecule it attaches to and becomes its unique tag.\n\n    ![](prerequisite_figures/Umis_after_capture.png)\n\n-   Thousands RNA molecule copies are created by PCR during library preparation.\n\n-   The RNA molecule copies, including the attached UMIs, are then sequenced.\n\nUMIs can help to differentiate PCR copies and we can quantify correctly the feature expression. After sequencing, we count the number of unique UMIs rather than the number of reads of a transcript as the feature expression. UMIs help to:\n\n-   **Remove PCR copies:** Because UMIs are unique to each original RNA molecule, any duplicates (multiple copies of the same RNA molecule) with the same UMI are likely the result of PCR amplification rather than a true molecule.\n\n-   **Count unique molecules:** By looking at the UMIs, one can count how many unique RNA molecules are originally present in the cell.\n\n-   **Quantify gene expression:** By counting the unique UMIs associated with each gene, one can measure the expression level of that gene in a cell. Genes with more UMIs are more active, while genes with fewer UMIs are less active.\n\nIn summary, UMIs are used to distinguish real feature molecules from PCR copies by providing a unique identifier for each original molecule.\n\n### 2.3.3 Output Files from the Primary Pipeline\n\nThe primary pipeline produces many output files. Below you can find a summary of output files relating to different assays.\n\n![](prerequisite_figures/output_files_cell.png)\n\nThe output files from the primary analysis are the input of the secondary analysis. In the course, we will work with demo data that includes WTA, AbSeq and SMK. You will get to know how to load the expression matrix (in MEX format), how to perform quality control and other steps that are commonly included in single cell analysis in Chapter 1 - 9.\n\n::: callout-important\nThe course will ONLY cover the secondary analysis.\n:::\n\n# 3. Additional Information on Running Primary Pipeline\n\nHere is how to set up and run the BD Rhapsody™ Analysis pipelines: BD® Single-Cell Multiomics Analysis Setup User Guide.  (<https://scomix.bd.com/hc/article_attachments/16954103767949>)\\\n\\\n- This guide provides detailed instructions on how to set up and run the BD Rhapsody™ Analysis pipelines on the Seven Bridges Genomics platform or a local installation.\\\n \\\nHere is the bioinformatics handbook as a resource: BD® Single-Cell Multiomics Bioinformatics Handbook. (<https://scomix.bd.com/hc/article_attachments/16954089124621>)\\\n\\\n- This handbook is a comprehensive reference to help you prepare and analyze single-cell libraries with the BD Rhapsody™ Single-Cell Analysis system or the BD Rhapsody™ Express Single-Cell Analysis system. Major aspects of the BD® Single-Cell Multiomics bioinformatics workflow are covered. This reference explains the BD single-cell multiomics sequencing analysis algorithms to deepen your understanding of how single-cell mRNA and protein (AbSeq) expression profiles are generated. In addition, the handbook defines every analysis metric.\\\n","srcMarkdownNoYaml":"\n\n# 1. Introduction\n\nOur body has many cell types with different functions and they interact with each other in a daily basis. We can imagine it like a bustling city with different workers specializing in different tasks.\n\nSingle-cell RNA sequencing (scRNAseq) can help to understand the cell types and their functionality. It's like taking a close-up picture of each cell and see which genes are active.\n\nThis technique can be applied to:\n\n-   Investigating different types of cells in a specific tissue. Example: Understanding the various cell types in the brain.\n\n-   Discovering noval cell types or states. Example: Identifying unique cell types in the immune system.\n\n-   Figuring out how genes change their activity as cells differentiate over time. Example: Tracking gene expression dynamics such as stem cells differentiation.\n\n-   Finding genes that are active in certain cell types under certain conditions. Example: Finding genes that switch on and off in lung cells in asthma.\n\n-   Examining how gene activity changes within a cell type under certain conditions. Example: Studying how nerve cells in the spinal cord change their gene activity in response to injury.\n\n# 2. BD Rhapsody^™^ Single Cell Workflow\n\nThe BD Rhapsody^™^ Single Cell System enables capturing and barcoding of hundreds to thousands of single cells for the analysis of genomic and proteomic information.\n\nBefore proceeding with Rhapsody workflow, samples of interest are processed to have **live** **single cells in cell suspension**. It is optional to sort cells to concentrate on cell type of interest.\n\nThe sample preparation and experimental setup are crucial and have big impacts on data quality and the following analysis. We expect live single cells in cell suspension (avoid clumps or dead cells).\n\n![](prerequisite_figures/BD_single_cell_workflow.png)\n\nOnce we obtain single cell suspension, the cells are captured and barcoded by the BD Rhapsody^™^ Single-Cell Analysis System. Each cell is assigned with a unique cell barcode and mRNA molecules of a cell are tagged with that barcode. This helps to associate the RNA molecules with the corresponding cell in downstream analysis.\n\nThe data analysis and interpretation come as the last piece of the workflow. The upstream steps, including experimental design and sample processing, will define the analysis process: how we approach quality control, data integration or cell annotation, etc.\n\nIn the next chapter, you will learn which modality can be measured on the single cell level with BD Rhapsody^™^ System.\n\n## 2.1 BD Rhapsody^™^ Single Cell System\n\n![](prerequisite_figures/BD_Rhapsody_assays_summary.png)\n\nThe BD Rhapsody™ Single Cell System enables simultaneous measurement of multiple parameters in thousands of individual cells. By combining available assays, researchers can generate robust and intricate datasets to unlock powerful insights.\n\n**Gene Expression (scRNAseq):** The primary purpose of scRNAseq is to measure the gene expression in individual cells. This allows to understand which genes are active or inactive and to identify different cell types based on their gene expression profiles.\n\n**Antibody-Based Protein Analysis (AbSeq):** You can use antibodies conjugated with unique barcodes to measure protein expression alongside with gene expression in individual cells.\n\n**Sample multiplexing with antibody-based techniques (SMK):** **S**ample **m**ultiplexing **k**it (SMK) uses generic antibody conjugated with unique barcodes to label cells from different samples. This enables pooling of multiple samples on one cartridge.\n\n**Immune Repertoire Profiling (Full length V(D)J TCR/BCR):** Full length V(D)J assay profiles the diversity of T cell and/or B cell receptor repertoires. This is valuable for studying the immune response and identifying antigen-specific cells.\n\n**Antigen-Specific T-cell Analysis (DCode):** Immudex's DCode technology enables the profiling of T cells that recognize specific antigens such as viral epitopes or tumor-related antigens. This expands the offering of immune profiling, aiding vaccine development and immunotherapy research.\n\nFrom gene expression profiling to antibody-based protein analysis, all assays can be combined or performed standalone to explore cellular functions and molecular dynamics in single cell resolution.\n\n## 2.2 Overview of Single Cell Data Analysis\n\nIn general, the analysis of single cell data can be split into two parts.\n\nThe **primary analysis** transforms raw data (usually in fastq.gz format) into an expression matrix, where each row represents a gene, each column represents a cell, and each entry in the matrix contains the molecule counts of a particular feature (gene or protein) in a cell. **Secondary analysis** focuses on extracting meaningful biological insights from the expression matrix.\n\n![](prerequisite_figures/primary_secondary_analyses.png)\n\n## 2.3 Primary analysis - From Sequencing Data to Expression Matrix\n\nAfter sequencing, one will receive raw sequecning data. The raw sequencing data is usually in fastq.gz format. You may also see fq.gz.\n\nThe raw sequencing data is usually handled by the software, BD Rhapsody^™^ Primary Analysis Pipeline, to enables fast and easy data processing. In this chapter, we will cover key features of the pipeline and explain key concepts necessary to understand prior working with single cell data.\n\n### 2.3.1 BD Rhapsody^™^ Sequencing Analysis Pipeline\n\nThe BD Rhapsody^™^ Sequencing Analysis Pipeline contains a series of computational steps to process and extract meaningful information from the raw sequencing data generated by the BD Rhapsody^™^ Sinlge Cell System.\n\nThe goal of the primary analysis is to transform text-based genomic data into numerical data, and we achieve this through a series of steps in the pipeline. The steps of the pipeline are listed in simplified graphics below.\n\n![](prerequisite_figures/sequencing_pipeline.png){width=\"1000\"}\n\nThe main steps include decoding the unique barcodes and feature molecules associated with individual cells. Oftentimes, scRNAseq relies on **u**nique **m**olecular **i**dentifiers (UMIs) to quantify feature expression.\n\n### 2.3.2 Quantify feature expression with UMIs\n\n**U**nique **m**olecular **i**dentifiers (UMIs) are used to quantify featuer molecules in a cell. Here's how it works:\n\n-   **Bead structure:** UMIs are small, unique sequences of nucleotides that are added to the capture sequence of beads. Each bead contains tens of thousands of unique UMIs followed by the polyA capture sequence. Each UMI is specific to the molecule it attaches to and becomes its unique tag.\n\n    ![](prerequisite_figures/Umis_after_capture.png)\n\n-   Thousands RNA molecule copies are created by PCR during library preparation.\n\n-   The RNA molecule copies, including the attached UMIs, are then sequenced.\n\nUMIs can help to differentiate PCR copies and we can quantify correctly the feature expression. After sequencing, we count the number of unique UMIs rather than the number of reads of a transcript as the feature expression. UMIs help to:\n\n-   **Remove PCR copies:** Because UMIs are unique to each original RNA molecule, any duplicates (multiple copies of the same RNA molecule) with the same UMI are likely the result of PCR amplification rather than a true molecule.\n\n-   **Count unique molecules:** By looking at the UMIs, one can count how many unique RNA molecules are originally present in the cell.\n\n-   **Quantify gene expression:** By counting the unique UMIs associated with each gene, one can measure the expression level of that gene in a cell. Genes with more UMIs are more active, while genes with fewer UMIs are less active.\n\nIn summary, UMIs are used to distinguish real feature molecules from PCR copies by providing a unique identifier for each original molecule.\n\n### 2.3.3 Output Files from the Primary Pipeline\n\nThe primary pipeline produces many output files. Below you can find a summary of output files relating to different assays.\n\n![](prerequisite_figures/output_files_cell.png)\n\nThe output files from the primary analysis are the input of the secondary analysis. In the course, we will work with demo data that includes WTA, AbSeq and SMK. You will get to know how to load the expression matrix (in MEX format), how to perform quality control and other steps that are commonly included in single cell analysis in Chapter 1 - 9.\n\n::: callout-important\nThe course will ONLY cover the secondary analysis.\n:::\n\n# 3. Additional Information on Running Primary Pipeline\n\nHere is how to set up and run the BD Rhapsody™ Analysis pipelines: BD® Single-Cell Multiomics Analysis Setup User Guide.  (<https://scomix.bd.com/hc/article_attachments/16954103767949>)\\\n\\\n- This guide provides detailed instructions on how to set up and run the BD Rhapsody™ Analysis pipelines on the Seven Bridges Genomics platform or a local installation.\\\n \\\nHere is the bioinformatics handbook as a resource: BD® Single-Cell Multiomics Bioinformatics Handbook. (<https://scomix.bd.com/hc/article_attachments/16954089124621>)\\\n\\\n- This handbook is a comprehensive reference to help you prepare and analyze single-cell libraries with the BD Rhapsody™ Single-Cell Analysis system or the BD Rhapsody™ Express Single-Cell Analysis system. Major aspects of the BD® Single-Cell Multiomics bioinformatics workflow are covered. This reference explains the BD single-cell multiomics sequencing analysis algorithms to deepen your understanding of how single-cell mRNA and protein (AbSeq) expression profiles are generated. In addition, the handbook defines every analysis metric.\\\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"tidy":true,"message":false,"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"precourse_preparation_theory.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.340","theme":"cosmo","title":"Precourse Preparation - Theory"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}